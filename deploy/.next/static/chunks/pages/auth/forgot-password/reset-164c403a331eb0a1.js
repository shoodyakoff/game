(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[646],{1969:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/forgot-password/reset",function(){return r(5794)}])},5794:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return x}});var t=r(5893),a=r(7294),i=r(1163),o=r(9008),n=r.n(o),c=r(1664),l=r.n(c),d=r(3495),m=r(7066);function x(){let e=(0,i.useRouter)(),{token:s}=e.query,[r,o]=(0,a.useState)({password:"",confirmPassword:""}),[c,x]=(0,a.useState)(!1),[p,h]=(0,a.useState)({text:"",error:!1}),[w,u]=(0,a.useState)(!1),[f,y]=(0,a.useState)({password:"",confirmPassword:""});(0,a.useEffect)(()=>{s&&j()},[s]);let j=async()=>{try{x(!0),await m.Z.get("/api/auth/forgot-password/verify?token=".concat(s)),u(!0)}catch(e){u(!1),h({text:"Ссылка для сброса пароля недействительна или просрочена",error:!0})}finally{x(!1)}},g=e=>{let{name:s,value:t}=e.target;o({...r,[s]:t}),f[s]&&y({...f,[s]:""}),"confirmPassword"===s&&t!==r.password?y({...f,confirmPassword:"Пароли не совпадают"}):"password"===s&&r.confirmPassword&&t!==r.confirmPassword?y({...f,confirmPassword:"Пароли не совпадают"}):"confirmPassword"===s&&t===r.password&&y({...f,confirmPassword:""})},N=()=>{let e={password:"",confirmPassword:""},s=!0;return r.password.length<6&&(e.password="Пароль должен содержать не менее 6 символов",s=!1),r.password!==r.confirmPassword&&(e.confirmPassword="Пароли не совпадают",s=!1),y(e),s},b=async t=>{if(t.preventDefault(),N()){x(!0),h({text:"",error:!1});try{await m.Z.post("/api/auth/forgot-password/reset",{token:s,password:r.password}),h({text:"Пароль успешно изменен!",error:!1}),setTimeout(()=>{e.push("/auth/login")},3e3)}catch(e){var a,i;h({text:(null===(a=e.response)||void 0===a?void 0:null===(i=a.data)||void 0===i?void 0:i.message)||"Произошла ошибка при сбросе пароля",error:!0})}finally{x(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n(),{children:[(0,t.jsx)("title",{children:"Сброс пароля | GOTOGROW"}),(0,t.jsx)("meta",{name:"description",content:"Введите новый пароль для вашего аккаунта"})]}),(0,t.jsx)(d.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"min-h-screen bg-gradient-to-br from-gray-900 to-slate-900 flex flex-col justify-center items-center px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)(d.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"w-full max-w-md",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)(d.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"mb-6",children:(0,t.jsx)("div",{className:"h-20 mx-auto flex items-center justify-center",children:(0,t.jsxs)("h1",{className:"text-3xl font-bold text-indigo-400",children:["GAME",(0,t.jsx)("span",{className:"text-white",children:"PORTAL"})]})})}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Создание нового пароля"}),(0,t.jsx)("p",{className:"text-gray-300",children:"Введите новый пароль для вашего аккаунта"})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-xl p-6 sm:p-8",children:[p.text&&(0,t.jsx)(d.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},className:"".concat(p.error?"bg-red-500/10 border-red-500/50 text-red-300":"bg-green-500/10 border-green-500/50 text-green-300"," border px-4 py-3 rounded mb-6"),children:(0,t.jsx)("p",{children:p.text})}),c&&!p.text?(0,t.jsx)("div",{className:"py-8 flex justify-center",children:(0,t.jsxs)("svg",{className:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):w&&!p.error?(0,t.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"Новый пароль"}),(0,t.jsx)("input",{id:"password",name:"password",type:"password",required:!0,value:r.password,onChange:g,className:"input-primary w-full ".concat(f.password?"border-red-500":""),placeholder:"••••••••"}),f.password&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:f.password})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"Подтвердите пароль"}),(0,t.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,value:r.confirmPassword,onChange:g,className:"input-primary w-full ".concat(f.confirmPassword?"border-red-500":""),placeholder:"••••••••"}),f.confirmPassword&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-400",children:f.confirmPassword})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"submit",disabled:c,className:"btn-primary w-full",children:c?(0,t.jsxs)("span",{className:"flex items-center justify-center",children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Сохранение..."]}):"Сохранить новый пароль"})})]}):null,!c&&(!s||p.error)&&(0,t.jsx)("div",{className:"text-center py-4",children:(0,t.jsx)(l(),{href:"/auth/forgot-password",className:"text-blue-400 hover:text-blue-300",children:"Запросить новую ссылку для сброса пароля"})})]}),(0,t.jsx)("div",{className:"mt-8 text-center text-sm text-gray-400",children:(0,t.jsx)(l(),{href:"/auth/login",className:"hover:text-white",children:"← Вернуться на страницу входа"})})]})})]})}}},function(e){e.O(0,[495,664,774,888,179],function(){return e(e.s=1969)}),_N_E=e.O()}]);