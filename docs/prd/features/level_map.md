# Карта уровней

## Общее описание
Карта уровней представляет собой визуальное представление прогресса игрока в игре. Она отображает все доступные уровни, их статус (заблокированный, доступный, пройденный) и сложность. С карты также можно перейти в профиль пользователя или сменить персонажа.

## Функциональность

### Отображение уровней
- Визуализация всех уровней игры на карте
- Индикация статуса каждого уровня:
  - Заблокированный (недоступный)
  - Доступный (можно начать)
  - Пройденный (завершенный)
- Отображение сложности каждого уровня (легкий, средний, сложный)
- Тематическое оформление для разных категорий уровней

### Навигация
- Выбор уровня для начала прохождения
- Возможность прокрутки/зума карты при большом количестве уровней
- Переход к профилю пользователя через кнопку/аватар в верхней части экрана
- Кнопка для смены персонажа с переходом на страницу выбора персонажа
- Доступ к настройкам и дополнительным функциям через меню

### Начало уровня
- При выборе уровня открывается диалоговое окно с детальной информацией
- В диалоговом окне доступны следующие элементы:
  - Название и описание уровня
  - Сложность уровня
  - Информация о текущем персонаже
  - Кнопка "Сменить персонажа" для быстрого перехода на страницу выбора персонажа
  - Кнопка "Начать уровень" для старта
- Смена персонажа перед началом уровня не требует возврата на карту уровней

### Прогресс
- Визуальное отображение прогресса прохождения игры
- Отображение количества пройденных/доступных уровней
- Индикация количества заработанных очков/наград

## Интерфейс

### Дизайн карты
- Стилизованная карта с узлами (уровнями), соединенными путями
- Анимации при наведении на уровни
- Визуальные эффекты для обозначения особых уровней
- Детальная информация при выборе уровня:
  - Название уровня
  - Краткое описание
  - Сложность
  - Требования для прохождения
  - Возможные награды

### Элементы управления
- Кнопка профиля пользователя в верхней части экрана
- Индикатор общего прогресса
- Фильтры для отображения уровней по категориям/сложности
- Кнопка "Начать уровень" для выбранного доступного уровня
- Кнопка "Сменить персонажа" для перехода на страницу выбора персонажа

### Информация о персонаже
- Отображение аватара выбранного персонажа
- Отображение типа персонажа и его основных характеристик
- Индикатор уровня сложности, связанный с выбранным персонажем
- Подсказки о преимуществах выбранного персонажа для конкретных уровней

### Модальное окно начала уровня
- Отображается при выборе уровня
- Содержит подробную информацию о выбранном уровне
- Информация о текущем персонаже и его соответствии уровню
- Кнопка "Сменить персонажа" для быстрого доступа к экрану выбора персонажа
- Кнопка "Начать уровень" для запуска выбранного уровня
- Возможность закрыть модальное окно и вернуться к карте

## Технические требования

### API Endpoints

#### GET /api/levels
- Получение списка всех уровней
- Требует JWT-аутентификацию
- Возвращает массив объектов уровней с информацией о их статусе для текущего пользователя

#### GET /api/levels/:id
- Получение детальной информации о конкретном уровне
- Требует JWT-аутентификацию
- Возвращает детальную информацию о выбранном уровне

#### GET /api/users/me/progress
- Получение информации о прогрессе пользователя
- Требует JWT-аутентификацию
- Возвращает информацию о прогрессе пользователя

### База данных (MongoDB)
- Коллекция `levels`:
  ```json
  {
    "_id": "ObjectId",
    "name": "String",
    "description": "String",
    "difficulty": "String",
    "category": "String",
    "requirements": {
      "previousLevels": "Array",
      "minimumRank": "Number"
    },
    "rewards": {
      "experience": "Number",
      "items": "Array"
    },
    "position": {
      "x": "Number",
      "y": "Number"
    },
    "createdAt": "Date",
    "updatedAt": "Date"
  }
  ```

- Коллекция `userProgress`:
  ```json
  {
    "_id": "ObjectId",
    "userId": "ObjectId",
    "completedLevels": [
      {
        "levelId": "ObjectId",
        "completedAt": "Date",
        "score": "Number",
        "timeSpent": "Number"
      }
    ],
    "unlockedLevels": ["ObjectId"],
    "currentLevel": "ObjectId",
    "createdAt": "Date",
    "updatedAt": "Date"
  }
  ```

## Интеграция с другими системами

### Интеграция с системой профиля
- Кнопка/меню для перехода к профилю пользователя
- Отображение основной информации о пользователе (аватар, имя, уровень)
- Синхронизация данных о прогрессе между картой и профилем

### Интеграция с системой персонажей
- Отображение текущего персонажа пользователя на карте
- Кнопка для смены персонажа с перенаправлением на страницу выбора персонажа
- Особенности отображения карты в зависимости от типа персонажа
- Подсветка уровней, для которых выбранный персонаж имеет преимущества
- Возможность сменить персонажа перед началом любого уровня через модальное окно
- Система подсказок о соответствии выбранного персонажа оптимальному прохождению уровня

### Интеграция с системой уровней
- Отображение статуса каждого уровня в зависимости от прогресса пользователя
- Запуск выбранного уровня при нажатии на соответствующий узел карты
- Обновление статуса уровней после их прохождения

## Маршрутизация и проверки
- Страница карты уровней доступна по маршруту `/levels`
- Перед отображением карты уровней проверяется наличие выбранного персонажа
- Если персонаж не выбран, происходит автоматическое перенаправление на страницу выбора персонажа
- Страница поддерживает параметры URL для предварительного выбора уровня 