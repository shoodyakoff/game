# Система персонажей

## Общее описание
Система персонажей позволяет игроку выбрать одного из 5 специализированных типов Product Manager'ов, каждый с уникальными характеристиками и уровнем сложности игры. Функциональность выбора имени и типа персонажа определяет начальные характеристики и стартовые возможности игрока, с сохранением данных в базе данных.

## Пользовательский сценарий
1. После успешной регистрации пользователь попадает на страницу создания персонажа
2. Пользователь вводит имя своего персонажа
3. Пользователь выбирает тип PM из представленных вариантов
4. Пользователь видит базовые характеристики выбранного типа персонажа
5. Пользователь подтверждает выбор нажатием кнопки "Продолжить"
6. Система сохраняет данные персонажа в базе данных
7. Пользователь перенаправляется на карту уровней

## Типы персонажей

### 1. Product Lead (Стратег)
- **Уровень сложности**: Нормальная
- **Роль**: Стратег
- **Описание**: Фокусируется на стратегическом планировании и балансировании потребностей
- **Особенности**:
  - Сбалансированные характеристики
  - Хорошо подходит для новичков
  - Фокус на стратегическом планировании
- **Характеристики**:
  - Аналитика: 7/10
  - Коммуникация: 7/10
  - Стратегия: 8/10
  - Техническое понимание: 5/10
  - Креативность: 5/10
- **Стартовые предметы**:
  - Стратегическая карта (дает бонус к пониманию бизнес-целей)
  - Книга "Основы продуктового менеджмента" (снижает сложность базовых задач)

### 2. Agile Coach (Поддержка)
- **Уровень сложности**: Сложная
- **Роль**: Поддержка
- **Описание**: Фокусируется на процессах и командной работе
- **Особенности**:
  - Фокус на управлении командой
  - Сильные стороны в организации процессов
  - Умение разрешать конфликты
- **Характеристики**:
  - Аналитика: 5/10
  - Коммуникация: 9/10
  - Стратегия: 6/10
  - Техническое понимание: 4/10
  - Лидерство: 8/10
- **Стартовые предметы**:
  - Agile манифест (улучшает командную работу)
  - Набор фасилитатора (дает бонус при проведении совещаний)

### 3. Growth Hacker (DPS)
- **Уровень сложности**: Экстрим
- **Роль**: DPS
- **Описание**: Фокусируется на метриках и максимизации пользовательской базы
- **Особенности**:
  - Максимальный фокус на метриках
  - Быстрое принятие решений
  - Высокий риск и высокая отдача
- **Характеристики**:
  - Аналитика: 9/10
  - Коммуникация: 4/10
  - Стратегия: 6/10
  - Техническое понимание: 7/10
  - Креативность: 7/10
- **Стартовые предметы**:
  - Аналитическая платформа (ускоряет анализ данных)
  - Набор A/B тестирования (повышает точность экспериментов)

### 4. UX Visionary (Дизайнер)
- **Уровень сложности**: Легкая
- **Роль**: Дизайнер
- **Описание**: Фокусируется на пользовательском опыте и креативных решениях
- **Особенности**:
  - Фокус на пользовательском опыте
  - Интуитивное понимание потребностей пользователей
  - Креативное решение задач
- **Характеристики**:
  - Аналитика: 6/10
  - Коммуникация: 7/10
  - Стратегия: 5/10
  - Техническое понимание: 4/10
  - Креативность: 9/10
- **Стартовые предметы**:
  - Набор прототипов (ускоряет создание пользовательских сценариев)
  - Книга паттернов дизайна (дает бонус при решении UX-задач)

### 5. Tech PM (Гибрид)
- **Уровень сложности**: Сложная
- **Роль**: Гибрид
- **Описание**: Технически ориентированный PM с глубоким пониманием разработки
- **Особенности**:
  - Технический бэкграунд
  - Глубокое понимание разработки
  - Эффективное взаимодействие с инженерами
- **Характеристики**:
  - Аналитика: 6/10
  - Коммуникация: 5/10
  - Стратегия: 5/10
  - Техническое понимание: 9/10
- **Стартовые предметы**:
  - Техническая документация (позволяет лучше понимать технические ограничения)
  - Набор API-инструментов (помогает в работе с техническими задачами)

## Выбор персонажа

### Интерфейс выбора
- Отображение всех 5 типов персонажей с уникальными аватарами
- Индикация уровня сложности для каждого персонажа
- Описание способностей и особенностей каждого персонажа
- Кнопка для подтверждения выбора и продолжения

### Процесс выбора персонажа
1. После успешной авторизации пользователь перенаправляется на страницу выбора персонажа (`/character`)
2. Пользователь видит экран с 5 персонажами и их кратким описанием
3. При наведении или выборе отображается подробная информация о персонаже
4. Пользователь выбирает персонажа и нажимает кнопку "Выбрать персонажа"
5. Данные о выбранном персонаже сохраняются в БД, связываясь с аккаунтом пользователя
6. Пользователь перенаправляется на страницу уровней

### Смена персонажа
- Пользователь может изменить выбор персонажа в любое время
- Смена персонажа доступна в трех местах:
  1. На странице выбора уровней через отдельную кнопку
  2. Перед стартом каждого уровня через кнопку "Сменить персонажа"
  3. В профиле пользователя
- При смене персонажа обновляется только выбранный тип, прогресс пользователя сохраняется
- Никакая история смены персонажей не сохраняется

## Прогрессия персонажа

### Характеристики
- Каждый персонаж имеет набор базовых характеристик:
  - Аналитические способности
  - Коммуникативные навыки
  - Технические знания
  - Креативность
  - Лидерство

### Экипировка
- Персонажи могут получать и использовать уникальные предметы:
  - Инструменты аналитики
  - Коммуникационные инструменты
  - Технические гаджеты
  - Книги и руководства

## Технические требования

### Фронтенд
1. Страница создания персонажа (`/character`)
   - Поле для ввода имени персонажа
   - Выбор типа персонажа с визуальными аватарами
   - Отображение характеристик выбранного типа персонажа
   - Отображение стартовых предметов
   - Кнопка "Продолжить"
   - Анимации и визуальные эффекты при выборе персонажа

2. Компоненты:
   - Компонент выбора персонажа
   - Компонент отображения характеристик
   - Компонент отображения предметов
   - Форма ввода имени с валидацией
   - Компонент для смены персонажа перед началом уровня

### База данных (MongoDB)
- Обновление коллекции `users` для хранения выбранного персонажа:
  ```json
  {
    "_id": "ObjectId",
    "username": "String",
    "email": "String",
    "password": "String (hashed)",
    "selectedCharacter": {
      "type": "String",
      "lastSelected": "Date"
    },
    "createdAt": "Date",
    "updatedAt": "Date"
  }
  ```

- Коллекция `characters` со следующей структурой:
  ```json
  {
    "_id": "ObjectId",
    "userId": "ObjectId",
    "type": "String",
    "level": "Number",
    "experience": "Number",
    "equipment": "Array",
    "stats": {
      "analytics": "Number",
      "communication": "Number",
      "technical": "Number",
      "creativity": "Number",
      "leadership": "Number"
    },
    "createdAt": "Date",
    "updatedAt": "Date"
  }
  ```

### API Endpoints

#### GET /api/characters
- Получение списка всех доступных типов персонажей
- Требует JWT-аутентификацию
- Возвращает массив объектов типов персонажей с их характеристиками

#### POST /api/characters/select
- Выбор персонажа
- Требует JWT-аутентификацию
- Принимает: `type` (тип персонажа)
- Возвращает подтверждение выбора и обновленные данные пользователя

#### GET /api/users/me/character
- Получение информации о текущем выбранном персонаже пользователя
- Требует JWT-аутентификацию
- Возвращает объект с данными персонажа или null, если персонаж не выбран

### Безопасность
1. Проверка авторизации при создании и получении персонажа
2. Валидация всех входных данных
3. Привязка персонажа к конкретному пользователю
4. Проверка прав доступа при получении информации о персонаже

## Интеграция с другими системами

### Интеграция с системой уровней
- Персонаж влияет на доступность опций в диалогах
- Тип персонажа влияет на сложность заданий
- Специальные события для определенных типов персонажей
- Перед началом каждого уровня возможность сменить персонажа

### Интеграция с системой профиля
- Отображение информации о выбранном персонаже в профиле игрока
- Возможность смены персонажа через профиль
- Информация о текущем выбранном персонаже

### Интеграция с системой авторизации
- После входа система проверяет, выбран ли персонаж
- Если персонаж не выбран, пользователь перенаправляется на страницу выбора персонажа
- Если персонаж выбран, пользователь перенаправляется на страницу уровней

## Критерии готовности
1. Пользователь может успешно создать персонажа с выбранным типом
2. Все характеристики персонажа корректно отображаются и сохраняются в базе данных
3. Стартовые предметы добавляются в инвентарь персонажа и сохраняются в базе
4. Пользователь может просмотреть информацию о созданном персонаже
5. После создания персонажа пользователь корректно перенаправляется на карту уровней
6. Система корректно обрабатывает ошибки и отображает понятные сообщения
7. Данные синхронизируются между клиентом и сервером без потерь
8. Пользователь может изменить тип персонажа перед началом любого уровня 